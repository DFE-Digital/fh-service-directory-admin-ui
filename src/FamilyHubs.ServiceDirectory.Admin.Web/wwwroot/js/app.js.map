{"version":3,"sources":["tmp/js/app.js"],"names":["fhgov","this","init","restoreConditionalInputs","enhanceAccessibleAutocomplete","element","document","querySelector","HTMLElement","click","modelLaOrganisationName","getElementById","accessibleAutocomplete","enhanceSelectElement","defaultValue","value","name","selectElement","modelVcsOrganisationName","setupLanguageAutocompleteWhenAddAnother","languageSelects","querySelectorAll","forEach","select","MutationObserver","mutationsList","observer","childListMutation","some","mutation","type","addedNodes","length","attributesMutation","attributeName","targetElement","target","tagName","toLowerCase","getAttribute","console","log","id","input","replace","addGovUkClasses","classList","contains","observe","childList","subtree","attributes","errorState","add","window","addEventListener"],"mappings":"AAAA,SAASA,QACLC,KAAKC,KAAO,WACRC,IACAC,GACR,EACI,IAAID,EAA2B,WAC3B,MAAME,EAAUC,SAASC,cAAc,6BACnCF,aAAmBG,aACnBH,EAAQI,OAEpB,EACQL,EAAgC,WAEhC,MAAMM,EAA0BJ,SAASK,eAAe,2BACpDD,GACAE,uBAAuBC,qBAAqB,CACxCC,aAAcJ,EAAwBK,MACtCC,KAAM,qBACNC,cAAeX,SAASC,cAAc,yBAI9C,MAAMW,EAA2BZ,SAASK,eAAe,4BACrDO,GACAN,uBAAuBC,qBAAqB,CACxCC,aAAcI,EAAyBH,MACvCC,KAAM,sBACNC,cAAeX,SAASC,cAAc,yBAGtD,CACA,CAKA,SAASY,wCAAwCd,GAC7C,KAAMA,aAAmBG,aACrB,OAEJ,MAAMY,EAAkBf,EAAQgB,iBAAiB,2BACjDD,EAAgBE,SAAQ,SAAUC,GAC9BX,uBAAuBC,qBAAqB,CACxCG,KAAM,eACNF,aAAc,GACdG,cAAeM,GAE3B,IAWwB,IAAIC,kBAAiB,CAACC,EAAeC,KACrD,MAAMC,EAAoBF,EAAcG,MAAKC,GAA8B,cAAlBA,EAASC,MAAwBD,EAASE,WAAWC,OAAS,IAEjHC,EAAqBR,EAAcG,MAAKC,IAC1C,GAAsB,eAAlBA,EAASC,MAAoD,UAA3BD,EAASK,cAA2B,CACtE,MAAMC,EAAgBN,EAASO,OAC/B,MAA+C,UAAxCD,EAAcE,QAAQC,eAAoE,SAAvCH,EAAcI,aAAa,OACrG,CACY,OAAO,CAAK,KAEZZ,GAAqBM,IAErBb,EAAgBE,SAAQ,SAAUC,GAC9BiB,QAAQC,IAAIlB,EAAOmB,IACnB,MAAMC,EAAQrC,SAASK,eAAeY,EAAOmB,GAAGE,QAAQ,UAAW,KAEnE,GADAJ,QAAQC,IAAIE,IACPA,EACD,OAGJE,gBAAgBF,EADGpB,EAAOuB,UAAUC,SAAS,uBAE7D,GACA,IAEgBC,QAAQ3C,EAAS,CAAE4C,WAAW,EAAMC,SAAS,EAAMC,YAAY,GA6B/E,CACA,SAASN,gBAAgBF,EAAOS,GACvBT,EAAMG,UAAUC,SAAS,gBAC1BJ,EAAMG,UAAUO,IAAI,eAEpBD,IAAeT,EAAMG,UAAUC,SAAS,uBACxCJ,EAAMG,UAAUO,IAAI,qBAE5B,CAvFAC,OAAOtD,MAAQ,IAAIA,MACnBM,SAASiD,iBAAiB,oBAAoB,WAC1CD,OAAOtD,MAAME,MACjB,IAyFAiB,wCAAwC","file":"app.js","sourcesContent":["function fhgov() {\n    this.init = function () {\n        restoreConditionalInputs();\n        enhanceAccessibleAutocomplete();\n    };\n    let restoreConditionalInputs = function () {\n        const element = document.querySelector(\"[data-conditional-active]\");\n        if (element instanceof HTMLElement) {\n            element.click();\n        }\n    };\n    let enhanceAccessibleAutocomplete = function () {\n        //WhichLocalAuthority.cshtml && AddOrganisationWhichLocalAuthority.cshtml\n        const modelLaOrganisationName = document.getElementById('modelLaOrganisationName');\n        if (modelLaOrganisationName) {\n            accessibleAutocomplete.enhanceSelectElement({\n                defaultValue: modelLaOrganisationName.value,\n                name: 'LaOrganisationName',\n                selectElement: document.querySelector('#LaOrganisationName')\n            });\n        }\n        //WhichVcsOrganisation.cshtml\n        const modelVcsOrganisationName = document.getElementById('modelVcsOrganisationName');\n        if (modelVcsOrganisationName) {\n            accessibleAutocomplete.enhanceSelectElement({\n                defaultValue: modelVcsOrganisationName.value,\n                name: 'VcsOrganisationName',\n                selectElement: document.querySelector('#VcsOrganisationName')\n            });\n        }\n    };\n}\nwindow.fhgov = new fhgov();\ndocument.addEventListener('DOMContentLoaded', function () {\n    window.fhgov.init();\n});\nfunction setupLanguageAutocompleteWhenAddAnother(element) {\n    if (!(element instanceof HTMLElement)) {\n        return;\n    }\n    const languageSelects = element.querySelectorAll(\"select[id^='language-']\");\n    languageSelects.forEach(function (select) {\n        accessibleAutocomplete.enhanceSelectElement({\n            name: 'languageName',\n            defaultValue: '',\n            selectElement: select\n        });\n    });\n    // work around accessible-autocomplete not handling errors\n    // there's a discussion here about it...\n    // https://github.com/alphagov/accessible-autocomplete/issues/428\n    // but we've had to implement our own (hacky) solution by using MutationObserver\n    // and adding extra classes (with custom css) to the input element.\n    // I was going to package up this code into an exported function to ease reuse and maintanence,\n    // but someone is adding official support today (2024-01-12) so we should be able to remove this soon!\n    // https://github.com/alphagov/accessible-autocomplete/pull/602\n    //todo: fix aria-describedBy on the input too\n    // see https://github.com/alphagov/accessible-autocomplete/issues/589\n    const domObserver = new MutationObserver((mutationsList, observer) => {\n        const childListMutation = mutationsList.some(mutation => mutation.type === 'childList' && mutation.addedNodes.length > 0);\n        //const attributesMutation = mutationsList.some(mutation => mutation.type === 'attributes' && mutation.attributeName === 'class');\n        const attributesMutation = mutationsList.some(mutation => {\n            if (mutation.type === 'attributes' && mutation.attributeName === 'class') {\n                const targetElement = mutation.target;\n                return targetElement.tagName.toLowerCase() === 'input' && targetElement.getAttribute('type') === 'text';\n            }\n            return false;\n        });\n        if (childListMutation || attributesMutation) {\n            /*todo: create list of input ids outside of observer? */\n            languageSelects.forEach(function (select) {\n                console.log(select.id);\n                const input = document.getElementById(select.id.replace('-select', ''));\n                console.log(input);\n                if (!input) {\n                    return;\n                }\n                const errorState = select.classList.contains('govuk-select--error');\n                addGovUkClasses(input, errorState);\n            });\n        }\n    });\n    domObserver.observe(element, { childList: true, subtree: true, attributes: true });\n    //        for (let mutation of mutationsList) {\n    //            // The autocomplete component has been added to the DOM\n    //            // or \n    //            if ((mutation.type === 'childList' && mutation.addedNodes.length > 0)\n    //                || (mutation.type === 'attributes' && mutation.attributeName === 'class')) {\n    //                languageSelects.forEach(function (select) {\n    //                    console.log(select.id);\n    //                    const input = document.getElementById(select.id.replace('-select', '')) as HTMLInputElement;\n    //                    console.log(input);\n    //                    if (!input) {\n    //                        return;\n    //                    }\n    //                    const errorState = select.classList.contains('govuk-select--error');\n    //                    addGovUkClasses(input, errorState);\n    //                //    const observer = new MutationObserver((mutationsList, observer) => {\n    //                //        for (let mutation of mutationsList) {\n    //                //            if (mutation.type === 'attributes' && mutation.attributeName === 'class') {\n    //                //                console.log('adding classes to ' + input.id);\n    //                //                addGovUkClasses(input, errorState);\n    //                //            }\n    //                //        }\n    //                //    });\n    //                //    observer.observe(input, { attributes: true });\n    //                });\n    //            }\n    //        }\n    //    });\n    //    domObserver.observe(element, { childList: true, subtree: true, attributes: true });\n}\nfunction addGovUkClasses(input, errorState) {\n    if (!input.classList.contains('govuk-input')) {\n        input.classList.add('govuk-input');\n    }\n    if (errorState && !input.classList.contains('govuk-input--error')) {\n        input.classList.add('govuk-input--error');\n    }\n}\n//todo: this is a hack - we want setupLanguageAutocompleteWhenAddAnother to be in the generated js file.\n// if we export it, it includes the export keyword in the generated js file\n// (but we use export in the other ts files, without the js containing export!)\n// so as a workaround we call it where it no-ops\nsetupLanguageAutocompleteWhenAddAnother(null);\nexport {};\n//});\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,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b0JBQW9CO0lBQ3BCLG1GQUFtRjtJQUNuRiw4RkFBOEY7SUFFOUYsNkRBQTZEO0lBQzdELDZDQUE2QztJQUM3QyxrSEFBa0g7SUFDbEgseUNBQXlDO0lBRXpDLG1DQUFtQztJQUNuQyxpQ0FBaUM7SUFDakMsdUJBQXVCO0lBRXZCLDBGQUEwRjtJQUUxRix5REFBeUQ7SUFFekQsNEZBQTRGO0lBQzVGLGlFQUFpRTtJQUNqRSwyR0FBMkc7SUFFM0csaUZBQWlGO0lBQ2pGLHVFQUF1RTtJQUN2RSxpQ0FBaUM7SUFDakMsNkJBQTZCO0lBQzdCLDJCQUEyQjtJQUUzQixzRUFBc0U7SUFDdEUscUJBQXFCO0lBQ3JCLGVBQWU7SUFDZixXQUFXO0lBQ1gsU0FBUztJQUVULHlGQUF5RjtBQUN6RixDQUFDO0FBRUQsU0FBUyxlQUFlLENBQUMsS0FBdUIsRUFBRSxVQUFtQjtJQUNqRSxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQztRQUMzQyxLQUFLLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUN2QyxDQUFDO0lBRUQsSUFBSSxVQUFVLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxvQkFBb0IsQ0FBQyxFQUFFLENBQUM7UUFDaEUsS0FBSyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsb0JBQW9CLENBQUMsQ0FBQztJQUM5QyxDQUFDO0FBQ0wsQ0FBQztBQUVELHdHQUF3RztBQUN4RywyRUFBMkU7QUFDM0UsK0VBQStFO0FBQy9FLGdEQUFnRDtBQUNoRCx1Q0FBdUMsQ0FBQyxJQUFJLENBQUMsQ0FBQzs7QUFDOUMsS0FBSyIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgeyB9O1xyXG5cclxuZGVjbGFyZSBjb25zdCBhY2Nlc3NpYmxlQXV0b2NvbXBsZXRlOiBhbnk7XHJcbmRlY2xhcmUgZ2xvYmFsIHtcclxuICAgIGludGVyZmFjZSBXaW5kb3cge1xyXG4gICAgICAgIGZoZ292OiBhbnk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZoZ292KCkge1xyXG4gICAgdGhpcy5pbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJlc3RvcmVDb25kaXRpb25hbElucHV0cygpO1xyXG4gICAgICAgIGVuaGFuY2VBY2Nlc3NpYmxlQXV0b2NvbXBsZXRlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGxldCByZXN0b3JlQ29uZGl0aW9uYWxJbnB1dHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJbZGF0YS1jb25kaXRpb25hbC1hY3RpdmVdXCIpO1xyXG4gICAgICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgZWxlbWVudC5jbGljaygpXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBsZXQgZW5oYW5jZUFjY2Vzc2libGVBdXRvY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIC8vV2hpY2hMb2NhbEF1dGhvcml0eS5jc2h0bWwgJiYgQWRkT3JnYW5pc2F0aW9uV2hpY2hMb2NhbEF1dGhvcml0eS5jc2h0bWxcclxuICAgICAgICBjb25zdCBtb2RlbExhT3JnYW5pc2F0aW9uTmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RlbExhT3JnYW5pc2F0aW9uTmFtZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICAgICAgaWYgKG1vZGVsTGFPcmdhbmlzYXRpb25OYW1lKSB7XHJcbiAgICAgICAgICAgIGFjY2Vzc2libGVBdXRvY29tcGxldGUuZW5oYW5jZVNlbGVjdEVsZW1lbnQoe1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiBtb2RlbExhT3JnYW5pc2F0aW9uTmFtZS52YWx1ZSxcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdMYU9yZ2FuaXNhdGlvbk5hbWUnLFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0RWxlbWVudDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI0xhT3JnYW5pc2F0aW9uTmFtZScpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9XaGljaFZjc09yZ2FuaXNhdGlvbi5jc2h0bWxcclxuICAgICAgICBjb25zdCBtb2RlbFZjc09yZ2FuaXNhdGlvbk5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kZWxWY3NPcmdhbmlzYXRpb25OYW1lJykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICBpZiAobW9kZWxWY3NPcmdhbmlzYXRpb25OYW1lKSB7XHJcbiAgICAgICAgICAgIGFjY2Vzc2libGVBdXRvY29tcGxldGUuZW5oYW5jZVNlbGVjdEVsZW1lbnQoe1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiBtb2RlbFZjc09yZ2FuaXNhdGlvbk5hbWUudmFsdWUsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnVmNzT3JnYW5pc2F0aW9uTmFtZScsXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RFbGVtZW50OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjVmNzT3JnYW5pc2F0aW9uTmFtZScpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG53aW5kb3cuZmhnb3YgPSBuZXcgZmhnb3YoKTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICB3aW5kb3cuZmhnb3YuaW5pdCgpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIHNldHVwTGFuZ3VhZ2VBdXRvY29tcGxldGVXaGVuQWRkQW5vdGhlcihlbGVtZW50OiBIVE1MRWxlbWVudCkge1xyXG5cclxuICAgIGlmICghKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbGFuZ3VhZ2VTZWxlY3RzID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwic2VsZWN0W2lkXj0nbGFuZ3VhZ2UtJ11cIikgYXMgTm9kZUxpc3RPZjxIVE1MU2VsZWN0RWxlbWVudD47XHJcblxyXG4gICAgbGFuZ3VhZ2VTZWxlY3RzLmZvckVhY2goZnVuY3Rpb24gKHNlbGVjdCkge1xyXG4gICAgICAgIGFjY2Vzc2libGVBdXRvY29tcGxldGUuZW5oYW5jZVNlbGVjdEVsZW1lbnQoe1xyXG4gICAgICAgICAgICBuYW1lOiAnbGFuZ3VhZ2VOYW1lJyxcclxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAnJyxcclxuICAgICAgICAgICAgc2VsZWN0RWxlbWVudDogc2VsZWN0XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyB3b3JrIGFyb3VuZCBhY2Nlc3NpYmxlLWF1dG9jb21wbGV0ZSBub3QgaGFuZGxpbmcgZXJyb3JzXHJcbiAgICAvLyB0aGVyZSdzIGEgZGlzY3Vzc2lvbiBoZXJlIGFib3V0IGl0Li4uXHJcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYWxwaGFnb3YvYWNjZXNzaWJsZS1hdXRvY29tcGxldGUvaXNzdWVzLzQyOFxyXG4gICAgLy8gYnV0IHdlJ3ZlIGhhZCB0byBpbXBsZW1lbnQgb3VyIG93biAoaGFja3kpIHNvbHV0aW9uIGJ5IHVzaW5nIE11dGF0aW9uT2JzZXJ2ZXJcclxuICAgIC8vIGFuZCBhZGRpbmcgZXh0cmEgY2xhc3NlcyAod2l0aCBjdXN0b20gY3NzKSB0byB0aGUgaW5wdXQgZWxlbWVudC5cclxuXHJcbiAgICAvLyBJIHdhcyBnb2luZyB0byBwYWNrYWdlIHVwIHRoaXMgY29kZSBpbnRvIGFuIGV4cG9ydGVkIGZ1bmN0aW9uIHRvIGVhc2UgcmV1c2UgYW5kIG1haW50YW5lbmNlLFxyXG4gICAgLy8gYnV0IHNvbWVvbmUgaXMgYWRkaW5nIG9mZmljaWFsIHN1cHBvcnQgdG9kYXkgKDIwMjQtMDEtMTIpIHNvIHdlIHNob3VsZCBiZSBhYmxlIHRvIHJlbW92ZSB0aGlzIHNvb24hXHJcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYWxwaGFnb3YvYWNjZXNzaWJsZS1hdXRvY29tcGxldGUvcHVsbC82MDJcclxuXHJcbiAgICAvL3RvZG86IGZpeCBhcmlhLWRlc2NyaWJlZEJ5IG9uIHRoZSBpbnB1dCB0b29cclxuICAgIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vYWxwaGFnb3YvYWNjZXNzaWJsZS1hdXRvY29tcGxldGUvaXNzdWVzLzU4OVxyXG5cclxuICAgIGNvbnN0IGRvbU9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9uc0xpc3QsIG9ic2VydmVyKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY2hpbGRMaXN0TXV0YXRpb24gPSBtdXRhdGlvbnNMaXN0LnNvbWUobXV0YXRpb24gPT4gbXV0YXRpb24udHlwZSA9PT0gJ2NoaWxkTGlzdCcgJiYgbXV0YXRpb24uYWRkZWROb2Rlcy5sZW5ndGggPiAwKTtcclxuICAgICAgICAvL2NvbnN0IGF0dHJpYnV0ZXNNdXRhdGlvbiA9IG11dGF0aW9uc0xpc3Quc29tZShtdXRhdGlvbiA9PiBtdXRhdGlvbi50eXBlID09PSAnYXR0cmlidXRlcycgJiYgbXV0YXRpb24uYXR0cmlidXRlTmFtZSA9PT0gJ2NsYXNzJyk7XHJcbiAgICAgICAgY29uc3QgYXR0cmlidXRlc011dGF0aW9uID0gbXV0YXRpb25zTGlzdC5zb21lKG11dGF0aW9uID0+IHtcclxuICAgICAgICAgICAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICdhdHRyaWJ1dGVzJyAmJiBtdXRhdGlvbi5hdHRyaWJ1dGVOYW1lID09PSAnY2xhc3MnKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRFbGVtZW50ID0gbXV0YXRpb24udGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldEVsZW1lbnQudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnaW5wdXQnICYmIHRhcmdldEVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJykgPT09ICd0ZXh0JztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChjaGlsZExpc3RNdXRhdGlvbiB8fCBhdHRyaWJ1dGVzTXV0YXRpb24pIHtcclxuICAgICAgICAgICAgLyp0b2RvOiBjcmVhdGUgbGlzdCBvZiBpbnB1dCBpZHMgb3V0c2lkZSBvZiBvYnNlcnZlcj8gKi9cclxuICAgICAgICAgICAgbGFuZ3VhZ2VTZWxlY3RzLmZvckVhY2goZnVuY3Rpb24gKHNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZWN0LmlkKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2VsZWN0LmlkLnJlcGxhY2UoJy1zZWxlY3QnLCAnJykpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpbnB1dCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFpbnB1dCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBlcnJvclN0YXRlID0gc2VsZWN0LmNsYXNzTGlzdC5jb250YWlucygnZ292dWstc2VsZWN0LS1lcnJvcicpO1xyXG5cclxuICAgICAgICAgICAgICAgIGFkZEdvdlVrQ2xhc3NlcyhpbnB1dCwgZXJyb3JTdGF0ZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGRvbU9ic2VydmVyLm9ic2VydmUoZWxlbWVudCwgeyBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUsIGF0dHJpYnV0ZXM6IHRydWUgfSk7XHJcblxyXG4vLyAgICAgICAgZm9yIChsZXQgbXV0YXRpb24gb2YgbXV0YXRpb25zTGlzdCkge1xyXG4vLyAgICAgICAgICAgIC8vIFRoZSBhdXRvY29tcGxldGUgY29tcG9uZW50IGhhcyBiZWVuIGFkZGVkIHRvIHRoZSBET01cclxuLy8gICAgICAgICAgICAvLyBvciBcclxuLy8gICAgICAgICAgICBpZiAoKG11dGF0aW9uLnR5cGUgPT09ICdjaGlsZExpc3QnICYmIG11dGF0aW9uLmFkZGVkTm9kZXMubGVuZ3RoID4gMClcclxuLy8gICAgICAgICAgICAgICAgfHwgKG11dGF0aW9uLnR5cGUgPT09ICdhdHRyaWJ1dGVzJyAmJiBtdXRhdGlvbi5hdHRyaWJ1dGVOYW1lID09PSAnY2xhc3MnKSkge1xyXG5cclxuLy8gICAgICAgICAgICAgICAgbGFuZ3VhZ2VTZWxlY3RzLmZvckVhY2goZnVuY3Rpb24gKHNlbGVjdCkge1xyXG4vLyAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZWN0LmlkKTtcclxuLy8gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2VsZWN0LmlkLnJlcGxhY2UoJy1zZWxlY3QnLCAnJykpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbi8vICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpbnB1dCk7XHJcblxyXG4vLyAgICAgICAgICAgICAgICAgICAgaWYgKCFpbnB1dCkge1xyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuLy8gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbi8vICAgICAgICAgICAgICAgICAgICBjb25zdCBlcnJvclN0YXRlID0gc2VsZWN0LmNsYXNzTGlzdC5jb250YWlucygnZ292dWstc2VsZWN0LS1lcnJvcicpO1xyXG5cclxuLy8gICAgICAgICAgICAgICAgICAgIGFkZEdvdlVrQ2xhc3NlcyhpbnB1dCwgZXJyb3JTdGF0ZSk7XHJcblxyXG4vLyAgICAgICAgICAgICAgICAvLyAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnNMaXN0LCBvYnNlcnZlcikgPT4ge1xyXG4vLyAgICAgICAgICAgICAgICAvLyAgICAgICAgZm9yIChsZXQgbXV0YXRpb24gb2YgbXV0YXRpb25zTGlzdCkge1xyXG4vLyAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAnYXR0cmlidXRlcycgJiYgbXV0YXRpb24uYXR0cmlidXRlTmFtZSA9PT0gJ2NsYXNzJykge1xyXG5cclxuLy8gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2FkZGluZyBjbGFzc2VzIHRvICcgKyBpbnB1dC5pZCk7XHJcbi8vICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgIGFkZEdvdlVrQ2xhc3NlcyhpbnB1dCwgZXJyb3JTdGF0ZSk7XHJcbi8vICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgICAgICAgICAvLyAgICAgICAgfVxyXG4vLyAgICAgICAgICAgICAgICAvLyAgICB9KTtcclxuXHJcbi8vICAgICAgICAgICAgICAgIC8vICAgIG9ic2VydmVyLm9ic2VydmUoaW5wdXQsIHsgYXR0cmlidXRlczogdHJ1ZSB9KTtcclxuLy8gICAgICAgICAgICAgICAgfSk7XHJcbi8vICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgfVxyXG4vLyAgICB9KTtcclxuXHJcbi8vICAgIGRvbU9ic2VydmVyLm9ic2VydmUoZWxlbWVudCwgeyBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUsIGF0dHJpYnV0ZXM6IHRydWUgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZEdvdlVrQ2xhc3NlcyhpbnB1dDogSFRNTElucHV0RWxlbWVudCwgZXJyb3JTdGF0ZTogYm9vbGVhbikge1xyXG4gICAgaWYgKCFpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2dvdnVrLWlucHV0JykpIHtcclxuICAgICAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKCdnb3Z1ay1pbnB1dCcpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChlcnJvclN0YXRlICYmICFpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2dvdnVrLWlucHV0LS1lcnJvcicpKSB7XHJcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZCgnZ292dWstaW5wdXQtLWVycm9yJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vdG9kbzogdGhpcyBpcyBhIGhhY2sgLSB3ZSB3YW50IHNldHVwTGFuZ3VhZ2VBdXRvY29tcGxldGVXaGVuQWRkQW5vdGhlciB0byBiZSBpbiB0aGUgZ2VuZXJhdGVkIGpzIGZpbGUuXHJcbi8vIGlmIHdlIGV4cG9ydCBpdCwgaXQgaW5jbHVkZXMgdGhlIGV4cG9ydCBrZXl3b3JkIGluIHRoZSBnZW5lcmF0ZWQganMgZmlsZVxyXG4vLyAoYnV0IHdlIHVzZSBleHBvcnQgaW4gdGhlIG90aGVyIHRzIGZpbGVzLCB3aXRob3V0IHRoZSBqcyBjb250YWluaW5nIGV4cG9ydCEpXHJcbi8vIHNvIGFzIGEgd29ya2Fyb3VuZCB3ZSBjYWxsIGl0IHdoZXJlIGl0IG5vLW9wc1xyXG5zZXR1cExhbmd1YWdlQXV0b2NvbXBsZXRlV2hlbkFkZEFub3RoZXIobnVsbCk7XHJcbi8vfSk7Il19\n"]}