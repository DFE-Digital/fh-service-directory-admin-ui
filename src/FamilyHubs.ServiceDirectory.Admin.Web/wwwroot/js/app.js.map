{"version":3,"sources":["tmp/js/app.js"],"names":["fhgov","this","init","restoreConditionalInputs","enhanceAccessibleAutocomplete","element","document","querySelector","HTMLElement","click","modelLaOrganisationName","getElementById","accessibleAutocomplete","enhanceSelectElement","defaultValue","value","name","selectElement","modelVcsOrganisationName","setupLanguageAutocompleteWhenAddAnother","languageSelects","querySelectorAll","console","log","length","MutationObserver","mutationsList","observer","childListMutation","some","mutation","type","addedNodes","attributesMutation","attributeName","targetElement","target","tagName","toLowerCase","getAttribute","forEach","select","id","input","replace","addGovUkClasses","classList","contains","observe","childList","subtree","attributes","errorState","add","window","addEventListener"],"mappings":"AAAA,SAASA,QACLC,KAAKC,KAAO,WACRC,IACAC,GACR,EACI,IAAID,EAA2B,WAC3B,MAAME,EAAUC,SAASC,cAAc,6BACnCF,aAAmBG,aACnBH,EAAQI,OAEpB,EACQL,EAAgC,WAEhC,MAAMM,EAA0BJ,SAASK,eAAe,2BACpDD,GACAE,uBAAuBC,qBAAqB,CACxCC,aAAcJ,EAAwBK,MACtCC,KAAM,qBACNC,cAAeX,SAASC,cAAc,yBAI9C,MAAMW,EAA2BZ,SAASK,eAAe,4BACrDO,GACAN,uBAAuBC,qBAAqB,CACxCC,aAAcI,EAAyBH,MACvCC,KAAM,sBACNC,cAAeX,SAASC,cAAc,yBAGtD,CACA,CAKA,SAASY,wCAAwCd,GAC7C,KAAMA,aAAmBG,aACrB,OAEJ,MAAMY,EAAkBf,EAAQgB,iBAAiB,2BACjDC,QAAQC,IAAI,aAAeH,EAAgBI,OAAS,qBAYhC,IAAIC,kBAAiB,CAACC,EAAeC,KACrD,MAAMC,EAAoBF,EAAcG,MAAKC,GAA8B,cAAlBA,EAASC,MAAwBD,EAASE,WAAWR,OAAS,IACjHS,EAAqBP,EAAcG,MAAKC,IAC1C,GAAsB,eAAlBA,EAASC,MAAoD,UAA3BD,EAASI,cAA2B,CACtE,MAAMC,EAAgBL,EAASM,OAC/B,MAA+C,UAAxCD,EAAcE,QAAQC,eAAoE,SAAvCH,EAAcI,aAAa,OACrG,CACY,OAAO,CAAK,IAEZX,GACAN,QAAQC,IAAI,qBAEZU,GACAX,QAAQC,IAAI,uBAEZK,GAAqBK,IAErBb,EAAgBoB,SAAQ,SAAUC,GAC9BnB,QAAQC,IAAIkB,EAAOC,IACnB,MAAMC,EAAQrC,SAASK,eAAe8B,EAAOC,GAAGE,QAAQ,UAAW,KAEnE,GADAtB,QAAQC,IAAIoB,IACPA,EAED,YADArB,QAAQC,IAAI,6BAIhBsB,gBAAgBF,EADGF,EAAOK,UAAUC,SAAS,uBAE7D,GACA,IAEgBC,QAAQ3C,EAAS,CAAE4C,WAAW,EAAMC,SAAS,EAAMC,YAAY,IAC3E/B,EAAgBoB,SAAQ,SAAUC,GAC9B7B,uBAAuBC,qBAAqB,CACxCG,KAAM,eACNF,aAAc,GACdG,cAAewB,GAE3B,GACA,CACA,SAASI,gBAAgBF,EAAOS,GACvBT,EAAMG,UAAUC,SAAS,gBAC1BJ,EAAMG,UAAUO,IAAI,eAEpBD,IAAeT,EAAMG,UAAUC,SAAS,uBACxCJ,EAAMG,UAAUO,IAAI,qBAE5B,CAnEAC,OAAOtD,MAAQ,IAAIA,MACnBM,SAASiD,iBAAiB,oBAAoB,WAC1CD,OAAOtD,MAAME,MACjB,IAqEAiB,wCAAwC","file":"app.js","sourcesContent":["function fhgov() {\n    this.init = function () {\n        restoreConditionalInputs();\n        enhanceAccessibleAutocomplete();\n    };\n    let restoreConditionalInputs = function () {\n        const element = document.querySelector(\"[data-conditional-active]\");\n        if (element instanceof HTMLElement) {\n            element.click();\n        }\n    };\n    let enhanceAccessibleAutocomplete = function () {\n        //WhichLocalAuthority.cshtml && AddOrganisationWhichLocalAuthority.cshtml\n        const modelLaOrganisationName = document.getElementById('modelLaOrganisationName');\n        if (modelLaOrganisationName) {\n            accessibleAutocomplete.enhanceSelectElement({\n                defaultValue: modelLaOrganisationName.value,\n                name: 'LaOrganisationName',\n                selectElement: document.querySelector('#LaOrganisationName')\n            });\n        }\n        //WhichVcsOrganisation.cshtml\n        const modelVcsOrganisationName = document.getElementById('modelVcsOrganisationName');\n        if (modelVcsOrganisationName) {\n            accessibleAutocomplete.enhanceSelectElement({\n                defaultValue: modelVcsOrganisationName.value,\n                name: 'VcsOrganisationName',\n                selectElement: document.querySelector('#VcsOrganisationName')\n            });\n        }\n    };\n}\nwindow.fhgov = new fhgov();\ndocument.addEventListener('DOMContentLoaded', function () {\n    window.fhgov.init();\n});\nfunction setupLanguageAutocompleteWhenAddAnother(element) {\n    if (!(element instanceof HTMLElement)) {\n        return;\n    }\n    const languageSelects = element.querySelectorAll(\"select[id^='language-']\");\n    console.log('enhancing ' + languageSelects.length + ' language selects');\n    // work around accessible-autocomplete not handling errors or using standard govuk styling classes\n    // there's a discussion here about it...\n    // https://github.com/alphagov/accessible-autocomplete/issues/428\n    // but we've had to implement our own (hacky) solution by using MutationObserver\n    // and adding extra classes (with custom css) to the input element.\n    // I was going to either package up this code into an exported function to ease reuse and maintanence,\n    // or fork the accessible-autocomplete preact component, \n    // but someone is adding official support today (2024-01-12) so we should be able to remove this soon!\n    // https://github.com/alphagov/accessible-autocomplete/pull/602\n    //todo: fix aria-describedBy on the input too\n    // see https://github.com/alphagov/accessible-autocomplete/issues/589\n    const domObserver = new MutationObserver((mutationsList, observer) => {\n        const childListMutation = mutationsList.some(mutation => mutation.type === 'childList' && mutation.addedNodes.length > 0);\n        const attributesMutation = mutationsList.some(mutation => {\n            if (mutation.type === 'attributes' && mutation.attributeName === 'class') {\n                const targetElement = mutation.target;\n                return targetElement.tagName.toLowerCase() === 'input' && targetElement.getAttribute('type') === 'text';\n            }\n            return false;\n        });\n        if (childListMutation) {\n            console.log('childListMutation');\n        }\n        if (attributesMutation) {\n            console.log('attributesMutation');\n        }\n        if (childListMutation || attributesMutation) {\n            /*todo: create list of input ids outside of observer? */\n            languageSelects.forEach(function (select) {\n                console.log(select.id);\n                const input = document.getElementById(select.id.replace('-select', ''));\n                console.log(input);\n                if (!input) {\n                    console.log('no input found for select');\n                    return;\n                }\n                const errorState = select.classList.contains('govuk-select--error');\n                addGovUkClasses(input, errorState);\n            });\n        }\n    });\n    domObserver.observe(element, { childList: true, subtree: true, attributes: true });\n    languageSelects.forEach(function (select) {\n        accessibleAutocomplete.enhanceSelectElement({\n            name: 'languageName',\n            defaultValue: '',\n            selectElement: select\n        });\n    });\n}\nfunction addGovUkClasses(input, errorState) {\n    if (!input.classList.contains('govuk-input')) {\n        input.classList.add('govuk-input');\n    }\n    if (errorState && !input.classList.contains('govuk-input--error')) {\n        input.classList.add('govuk-input--error');\n    }\n}\n//todo: this is a hack - we want setupLanguageAutocompleteWhenAddAnother to be in the generated js file.\n// if we export it, it includes the export keyword in the generated js file\n// (but we use export in the other ts files, without the js containing export!)\n// so as a workaround we call it where it no-ops\nsetupLanguageAutocompleteWhenAddAnother(null);\nexport {};\n//});\n\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFTQSxTQUFTLEtBQUs7SUFDVixJQUFJLENBQUMsSUFBSSxHQUFHO1FBQ1Isd0JBQXdCLEVBQUUsQ0FBQztRQUMzQiw2QkFBNkIsRUFBRSxDQUFDO0lBQ3BDLENBQUMsQ0FBQztJQUVGLElBQUksd0JBQXdCLEdBQUc7UUFDM0IsTUFBTSxPQUFPLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO1FBQ3BFLElBQUksT0FBTyxZQUFZLFdBQVcsRUFBRSxDQUFDO1lBQ2pDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQTtRQUNuQixDQUFDO0lBRUwsQ0FBQyxDQUFBO0lBRUQsSUFBSSw2QkFBNkIsR0FBRztRQUVoQyx5RUFBeUU7UUFDekUsTUFBTSx1QkFBdUIsR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLHlCQUF5QixDQUFxQixDQUFDO1FBQ3ZHLElBQUksdUJBQXVCLEVBQUUsQ0FBQztZQUMxQixzQkFBc0IsQ0FBQyxvQkFBb0IsQ0FBQztnQkFDeEMsWUFBWSxFQUFFLHVCQUF1QixDQUFDLEtBQUs7Z0JBQzNDLElBQUksRUFBRSxvQkFBb0I7Z0JBQzFCLGFBQWEsRUFBRSxRQUFRLENBQUMsYUFBYSxDQUFDLHFCQUFxQixDQUFDO2FBQy9ELENBQUMsQ0FBQztRQUNQLENBQUM7UUFFRCw2QkFBNkI7UUFDN0IsTUFBTSx3QkFBd0IsR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLDBCQUEwQixDQUFxQixDQUFDO1FBQ3pHLElBQUksd0JBQXdCLEVBQUUsQ0FBQztZQUMzQixzQkFBc0IsQ0FBQyxvQkFBb0IsQ0FBQztnQkFDeEMsWUFBWSxFQUFFLHdCQUF3QixDQUFDLEtBQUs7Z0JBQzVDLElBQUksRUFBRSxxQkFBcUI7Z0JBQzNCLGFBQWEsRUFBRSxRQUFRLENBQUMsYUFBYSxDQUFDLHNCQUFzQixDQUFDO2FBQ2hFLENBQUMsQ0FBQTtRQUNOLENBQUM7SUFDTCxDQUFDLENBQUE7QUFDTCxDQUFDO0FBRUQsTUFBTSxDQUFDLEtBQUssR0FBRyxJQUFJLEtBQUssRUFBRSxDQUFDO0FBRTNCLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRTtJQUMxQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO0FBQ3hCLENBQUMsQ0FBQyxDQUFDO0FBRUgsU0FBUyx1Q0FBdUMsQ0FBQyxPQUFvQjtJQUVqRSxJQUFJLENBQUMsQ0FBQyxPQUFPLFlBQVksV0FBVyxDQUFDLEVBQUUsQ0FBQztRQUNwQyxPQUFPO0lBQ1gsQ0FBQztJQUVELE1BQU0sZUFBZSxHQUFHLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyx5QkFBeUIsQ0FBa0MsQ0FBQztJQUU3RyxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksR0FBRyxlQUFlLENBQUMsTUFBTSxHQUFHLG1CQUFtQixDQUFDLENBQUM7SUFFekUsa0dBQWtHO0lBQ2xHLHdDQUF3QztJQUN4QyxpRUFBaUU7SUFDakUsZ0ZBQWdGO0lBQ2hGLG1FQUFtRTtJQUVuRSxzR0FBc0c7SUFDdEcseURBQXlEO0lBQ3pELHNHQUFzRztJQUN0RywrREFBK0Q7SUFFL0QsNkNBQTZDO0lBQzdDLHFFQUFxRTtJQUVyRSxNQUFNLFdBQVcsR0FBRyxJQUFJLGdCQUFnQixDQUFDLENBQUMsYUFBYSxFQUFFLFFBQVEsRUFBRSxFQUFFO1FBQ2pFLE1BQU0saUJBQWlCLEdBQUcsYUFBYSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEtBQUssV0FBVyxJQUFJLFFBQVEsQ0FBQyxVQUFVLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQzFILE1BQU0sa0JBQWtCLEdBQUcsYUFBYSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUNyRCxJQUFJLFFBQVEsQ0FBQyxJQUFJLEtBQUssWUFBWSxJQUFJLFFBQVEsQ0FBQyxhQUFhLEtBQUssT0FBTyxFQUFFLENBQUM7Z0JBQ3ZFLE1BQU0sYUFBYSxHQUFHLFFBQVEsQ0FBQyxNQUFxQixDQUFDO2dCQUNyRCxPQUFPLGFBQWEsQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLEtBQUssT0FBTyxJQUFJLGFBQWEsQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLEtBQUssTUFBTSxDQUFDO1lBQzVHLENBQUM7WUFDRCxPQUFPLEtBQUssQ0FBQztRQUNqQixDQUFDLENBQUMsQ0FBQztRQUVILElBQUksaUJBQWlCLEVBQUUsQ0FBQztZQUNwQixPQUFPLENBQUMsR0FBRyxDQUFDLG1CQUFtQixDQUFDLENBQUM7UUFDckMsQ0FBQztRQUVELElBQUksa0JBQWtCLEVBQUUsQ0FBQztZQUNyQixPQUFPLENBQUMsR0FBRyxDQUFDLG9CQUFvQixDQUFDLENBQUM7UUFDdEMsQ0FBQztRQUVELElBQUksaUJBQWlCLElBQUksa0JBQWtCLEVBQUUsQ0FBQztZQUMxQyx3REFBd0Q7WUFDeEQsZUFBZSxDQUFDLE9BQU8sQ0FBQyxVQUFVLE1BQU07Z0JBQ3BDLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUN2QixNQUFNLEtBQUssR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxFQUFFLENBQUMsQ0FBcUIsQ0FBQztnQkFDNUYsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFFbkIsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO29CQUNULE9BQU8sQ0FBQyxHQUFHLENBQUMsMkJBQTJCLENBQUMsQ0FBQTtvQkFDeEMsT0FBTztnQkFDWCxDQUFDO2dCQUVELE1BQU0sVUFBVSxHQUFHLE1BQU0sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLHFCQUFxQixDQUFDLENBQUM7Z0JBRXBFLGVBQWUsQ0FBQyxLQUFLLEVBQUUsVUFBVSxDQUFDLENBQUM7WUFDdkMsQ0FBQyxDQUFDLENBQUM7UUFDUCxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxXQUFXLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztJQUVuRixlQUFlLENBQUMsT0FBTyxDQUFDLFVBQVUsTUFBTTtRQUNwQyxzQkFBc0IsQ0FBQyxvQkFBb0IsQ0FBQztZQUN4QyxJQUFJLEVBQUUsY0FBYztZQUNwQixZQUFZLEVBQUUsRUFBRTtZQUNoQixhQUFhLEVBQUUsTUFBTTtTQUN4QixDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUM7QUFFRCxTQUFTLGVBQWUsQ0FBQyxLQUF1QixFQUFFLFVBQW1CO0lBQ2pFLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDO1FBQzNDLEtBQUssQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7SUFFRCxJQUFJLFVBQVUsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLG9CQUFvQixDQUFDLEVBQUUsQ0FBQztRQUNoRSxLQUFLLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0lBQzlDLENBQUM7QUFDTCxDQUFDO0FBRUQsd0dBQXdHO0FBQ3hHLDJFQUEyRTtBQUMzRSwrRUFBK0U7QUFDL0UsZ0RBQWdEO0FBQ2hELHVDQUF1QyxDQUFDLElBQUksQ0FBQyxDQUFDOztBQUM5QyxLQUFLIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB7IH07XHJcblxyXG5kZWNsYXJlIGNvbnN0IGFjY2Vzc2libGVBdXRvY29tcGxldGU6IGFueTtcclxuZGVjbGFyZSBnbG9iYWwge1xyXG4gICAgaW50ZXJmYWNlIFdpbmRvdyB7XHJcbiAgICAgICAgZmhnb3Y6IGFueTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZmhnb3YoKSB7XHJcbiAgICB0aGlzLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmVzdG9yZUNvbmRpdGlvbmFsSW5wdXRzKCk7XHJcbiAgICAgICAgZW5oYW5jZUFjY2Vzc2libGVBdXRvY29tcGxldGUoKTtcclxuICAgIH07XHJcblxyXG4gICAgbGV0IHJlc3RvcmVDb25kaXRpb25hbElucHV0cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIltkYXRhLWNvbmRpdGlvbmFsLWFjdGl2ZV1cIik7XHJcbiAgICAgICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICBlbGVtZW50LmNsaWNrKClcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGxldCBlbmhhbmNlQWNjZXNzaWJsZUF1dG9jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgLy9XaGljaExvY2FsQXV0aG9yaXR5LmNzaHRtbCAmJiBBZGRPcmdhbmlzYXRpb25XaGljaExvY2FsQXV0aG9yaXR5LmNzaHRtbFxyXG4gICAgICAgIGNvbnN0IG1vZGVsTGFPcmdhbmlzYXRpb25OYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGVsTGFPcmdhbmlzYXRpb25OYW1lJykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICBpZiAobW9kZWxMYU9yZ2FuaXNhdGlvbk5hbWUpIHtcclxuICAgICAgICAgICAgYWNjZXNzaWJsZUF1dG9jb21wbGV0ZS5lbmhhbmNlU2VsZWN0RWxlbWVudCh7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6IG1vZGVsTGFPcmdhbmlzYXRpb25OYW1lLnZhbHVlLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogJ0xhT3JnYW5pc2F0aW9uTmFtZScsXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RFbGVtZW50OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjTGFPcmdhbmlzYXRpb25OYW1lJylcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL1doaWNoVmNzT3JnYW5pc2F0aW9uLmNzaHRtbFxyXG4gICAgICAgIGNvbnN0IG1vZGVsVmNzT3JnYW5pc2F0aW9uTmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RlbFZjc09yZ2FuaXNhdGlvbk5hbWUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgIGlmIChtb2RlbFZjc09yZ2FuaXNhdGlvbk5hbWUpIHtcclxuICAgICAgICAgICAgYWNjZXNzaWJsZUF1dG9jb21wbGV0ZS5lbmhhbmNlU2VsZWN0RWxlbWVudCh7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6IG1vZGVsVmNzT3JnYW5pc2F0aW9uTmFtZS52YWx1ZSxcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdWY3NPcmdhbmlzYXRpb25OYW1lJyxcclxuICAgICAgICAgICAgICAgIHNlbGVjdEVsZW1lbnQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNWY3NPcmdhbmlzYXRpb25OYW1lJylcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbndpbmRvdy5maGdvdiA9IG5ldyBmaGdvdigpO1xyXG5cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgIHdpbmRvdy5maGdvdi5pbml0KCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gc2V0dXBMYW5ndWFnZUF1dG9jb21wbGV0ZVdoZW5BZGRBbm90aGVyKGVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XHJcblxyXG4gICAgaWYgKCEoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBsYW5ndWFnZVNlbGVjdHMgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJzZWxlY3RbaWRePSdsYW5ndWFnZS0nXVwiKSBhcyBOb2RlTGlzdE9mPEhUTUxTZWxlY3RFbGVtZW50PjtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnZW5oYW5jaW5nICcgKyBsYW5ndWFnZVNlbGVjdHMubGVuZ3RoICsgJyBsYW5ndWFnZSBzZWxlY3RzJyk7XHJcblxyXG4gICAgLy8gd29yayBhcm91bmQgYWNjZXNzaWJsZS1hdXRvY29tcGxldGUgbm90IGhhbmRsaW5nIGVycm9ycyBvciB1c2luZyBzdGFuZGFyZCBnb3Z1ayBzdHlsaW5nIGNsYXNzZXNcclxuICAgIC8vIHRoZXJlJ3MgYSBkaXNjdXNzaW9uIGhlcmUgYWJvdXQgaXQuLi5cclxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hbHBoYWdvdi9hY2Nlc3NpYmxlLWF1dG9jb21wbGV0ZS9pc3N1ZXMvNDI4XHJcbiAgICAvLyBidXQgd2UndmUgaGFkIHRvIGltcGxlbWVudCBvdXIgb3duIChoYWNreSkgc29sdXRpb24gYnkgdXNpbmcgTXV0YXRpb25PYnNlcnZlclxyXG4gICAgLy8gYW5kIGFkZGluZyBleHRyYSBjbGFzc2VzICh3aXRoIGN1c3RvbSBjc3MpIHRvIHRoZSBpbnB1dCBlbGVtZW50LlxyXG5cclxuICAgIC8vIEkgd2FzIGdvaW5nIHRvIGVpdGhlciBwYWNrYWdlIHVwIHRoaXMgY29kZSBpbnRvIGFuIGV4cG9ydGVkIGZ1bmN0aW9uIHRvIGVhc2UgcmV1c2UgYW5kIG1haW50YW5lbmNlLFxyXG4gICAgLy8gb3IgZm9yayB0aGUgYWNjZXNzaWJsZS1hdXRvY29tcGxldGUgcHJlYWN0IGNvbXBvbmVudCwgXHJcbiAgICAvLyBidXQgc29tZW9uZSBpcyBhZGRpbmcgb2ZmaWNpYWwgc3VwcG9ydCB0b2RheSAoMjAyNC0wMS0xMikgc28gd2Ugc2hvdWxkIGJlIGFibGUgdG8gcmVtb3ZlIHRoaXMgc29vbiFcclxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hbHBoYWdvdi9hY2Nlc3NpYmxlLWF1dG9jb21wbGV0ZS9wdWxsLzYwMlxyXG5cclxuICAgIC8vdG9kbzogZml4IGFyaWEtZGVzY3JpYmVkQnkgb24gdGhlIGlucHV0IHRvb1xyXG4gICAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9hbHBoYWdvdi9hY2Nlc3NpYmxlLWF1dG9jb21wbGV0ZS9pc3N1ZXMvNTg5XHJcblxyXG4gICAgY29uc3QgZG9tT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zTGlzdCwgb2JzZXJ2ZXIpID0+IHtcclxuICAgICAgICBjb25zdCBjaGlsZExpc3RNdXRhdGlvbiA9IG11dGF0aW9uc0xpc3Quc29tZShtdXRhdGlvbiA9PiBtdXRhdGlvbi50eXBlID09PSAnY2hpbGRMaXN0JyAmJiBtdXRhdGlvbi5hZGRlZE5vZGVzLmxlbmd0aCA+IDApO1xyXG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXNNdXRhdGlvbiA9IG11dGF0aW9uc0xpc3Quc29tZShtdXRhdGlvbiA9PiB7XHJcbiAgICAgICAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAnYXR0cmlidXRlcycgJiYgbXV0YXRpb24uYXR0cmlidXRlTmFtZSA9PT0gJ2NsYXNzJykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0RWxlbWVudCA9IG11dGF0aW9uLnRhcmdldCBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRFbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2lucHV0JyAmJiB0YXJnZXRFbGVtZW50LmdldEF0dHJpYnV0ZSgndHlwZScpID09PSAndGV4dCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoY2hpbGRMaXN0TXV0YXRpb24pIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoaWxkTGlzdE11dGF0aW9uJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoYXR0cmlidXRlc011dGF0aW9uKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhdHRyaWJ1dGVzTXV0YXRpb24nKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjaGlsZExpc3RNdXRhdGlvbiB8fCBhdHRyaWJ1dGVzTXV0YXRpb24pIHtcclxuICAgICAgICAgICAgLyp0b2RvOiBjcmVhdGUgbGlzdCBvZiBpbnB1dCBpZHMgb3V0c2lkZSBvZiBvYnNlcnZlcj8gKi9cclxuICAgICAgICAgICAgbGFuZ3VhZ2VTZWxlY3RzLmZvckVhY2goZnVuY3Rpb24gKHNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZWN0LmlkKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2VsZWN0LmlkLnJlcGxhY2UoJy1zZWxlY3QnLCAnJykpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpbnB1dCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFpbnB1dCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdubyBpbnB1dCBmb3VuZCBmb3Igc2VsZWN0JylcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgZXJyb3JTdGF0ZSA9IHNlbGVjdC5jbGFzc0xpc3QuY29udGFpbnMoJ2dvdnVrLXNlbGVjdC0tZXJyb3InKTtcclxuXHJcbiAgICAgICAgICAgICAgICBhZGRHb3ZVa0NsYXNzZXMoaW5wdXQsIGVycm9yU3RhdGUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBkb21PYnNlcnZlci5vYnNlcnZlKGVsZW1lbnQsIHsgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlLCBhdHRyaWJ1dGVzOiB0cnVlIH0pO1xyXG5cclxuICAgIGxhbmd1YWdlU2VsZWN0cy5mb3JFYWNoKGZ1bmN0aW9uIChzZWxlY3QpIHtcclxuICAgICAgICBhY2Nlc3NpYmxlQXV0b2NvbXBsZXRlLmVuaGFuY2VTZWxlY3RFbGVtZW50KHtcclxuICAgICAgICAgICAgbmFtZTogJ2xhbmd1YWdlTmFtZScsXHJcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogJycsXHJcbiAgICAgICAgICAgIHNlbGVjdEVsZW1lbnQ6IHNlbGVjdFxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZEdvdlVrQ2xhc3NlcyhpbnB1dDogSFRNTElucHV0RWxlbWVudCwgZXJyb3JTdGF0ZTogYm9vbGVhbikge1xyXG4gICAgaWYgKCFpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2dvdnVrLWlucHV0JykpIHtcclxuICAgICAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKCdnb3Z1ay1pbnB1dCcpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChlcnJvclN0YXRlICYmICFpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2dvdnVrLWlucHV0LS1lcnJvcicpKSB7XHJcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZCgnZ292dWstaW5wdXQtLWVycm9yJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vdG9kbzogdGhpcyBpcyBhIGhhY2sgLSB3ZSB3YW50IHNldHVwTGFuZ3VhZ2VBdXRvY29tcGxldGVXaGVuQWRkQW5vdGhlciB0byBiZSBpbiB0aGUgZ2VuZXJhdGVkIGpzIGZpbGUuXHJcbi8vIGlmIHdlIGV4cG9ydCBpdCwgaXQgaW5jbHVkZXMgdGhlIGV4cG9ydCBrZXl3b3JkIGluIHRoZSBnZW5lcmF0ZWQganMgZmlsZVxyXG4vLyAoYnV0IHdlIHVzZSBleHBvcnQgaW4gdGhlIG90aGVyIHRzIGZpbGVzLCB3aXRob3V0IHRoZSBqcyBjb250YWluaW5nIGV4cG9ydCEpXHJcbi8vIHNvIGFzIGEgd29ya2Fyb3VuZCB3ZSBjYWxsIGl0IHdoZXJlIGl0IG5vLW9wc1xyXG5zZXR1cExhbmd1YWdlQXV0b2NvbXBsZXRlV2hlbkFkZEFub3RoZXIobnVsbCk7XHJcbi8vfSk7Il19\n"]}