@page
@model FamilyHubs.ServiceDirectory.Admin.Web.Pages.manage_services.Support_OfferedModel
@{
    ViewData["Title"] = "What support does the service offer?";
}

@section Back {
    <a href="@Model.BackUrl" class="govuk-back-link">Back</a>
}

@{
    Model.Errors.ErrorIdToHtmlElementId = _ => Model.UserInput.ErrorElementId;
}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        <partial name="_ErrorSummaryNext" model="Model.Errors" />

        <form method="post" novalidate data-validate="my-form-validation">
            <h1 class="govuk-heading-l">
                What support does the service offer?
            </h1>
            <p>Select the categories and subcategories of support that provides. </p>


            <div class="govuk-form-group">

                <div class="govuk-checkboxes" data-module="govuk-checkboxes">
                    @foreach (var category in Model.Taxonomies)
                    {
                        var categoryId = category.Key.Id;
                        var categoryName = category.Key.Name;

                        <div class="govuk-checkboxes__item">
                            <input class="govuk-checkboxes__input" id="category-@categoryId" name="UserInput.SelectedCategories" type="checkbox" aria-controls="group-@categoryId" aria-expanded="false" value="@categoryId"
                            @(Model.UserInput.SelectedCategories.Contains(categoryId) ? "checked=\"checked\"" : string.Empty)>
                            <label class="govuk-label govuk-checkboxes__label" for="category-@categoryId">
                                @categoryName
                            </label>
                        </div>
                        <div class="govuk-checkboxes__conditional govuk-checkboxes__conditional--hidden" id="group-@categoryId">
                            <div class="govuk-form-group">
                                <label class="govuk-label--s">
                                    @{
                                        var categoryDescription = Char.ToLower(@category.Key.Name[0]) + @category.Key.Name.Substring(1);
                                    }
                                    Select @categoryDescription
                                </label>
                                @foreach (var subCategory in category.Value)
                                {
                                    <div class="govuk-checkboxes govuk-checkboxes--small govuk-!-margin-top-2" data-module="govuk-checkboxes">
                                        <div class="govuk-checkboxes__item">
                                            <input class="govuk-checkboxes__input" id="category-@subCategory.Id" name="UserInput.SelectedSubCategories" type="checkbox" value="@subCategory.Id"
                                            @(Model.UserInput.SelectedSubCategories.Contains(subCategory.Id) ? "checked=\"checked\"" : string.Empty)>
                                            <label class="govuk-label govuk-checkboxes__label" for="category-@subCategory.Id">@subCategory.Name</label>
                                        </div>
                                    </div>
                                }
                            </div>

                        </div>
                    }
                </div>
            </div>
            <button type="submit" class="govuk-button" data-module="govuk-button">
                Continue
            </button>
        </form>
    </div>
</div>