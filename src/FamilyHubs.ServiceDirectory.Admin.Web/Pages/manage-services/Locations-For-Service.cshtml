@page
@using FamilyHubs.ServiceDirectory.Shared.Display
@using FamilyHubs.ServiceDirectory.Shared.Enums
@using FamilyHubs.SharedKernel.Razor.Summary
@using Microsoft.AspNetCore.Mvc.TagHelpers
@model FamilyHubs.ServiceDirectory.Admin.Web.Pages.manage_services.Locations_For_ServiceModel
@{
    string title = $"Locations for {Model.ServiceModel!.Name}";
    ViewData["Title"] = "title";

    //todo: this common bit of code needs to be somewhere common - ServicePageModel?
    var linkFlow = Model.Flow; // == JourneyFlow.Edit ? JourneyFlow.Edit : JourneyFlow.AddRedo;
}

@section Back {
    <a href="@Model.BackUrl" class="govuk-back-link">Back</a>
}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        <h1 class="govuk-heading-l">@title</h1>

        <p>These locations will be added to this service.</p>

        <form method="post" novalidate>
            
            @{
                int locationIndex = 0;
                foreach (var location in Model.Locations)
                {
                    ++locationIndex;
                    <summary-card title="Location @locationIndex"
                                  action1="Remove location from this service" action1-href="@(Model.GetServicePageUrl(ServiceJourneyPage.Remove_Location, linkFlow))&locationId=@location.Id">
                        <summary-row key="Address" class="fh-pre-wrap">@string.Join(", ", location.GetAddress())</summary-row>
                        <summary-row key="Family hub">
                            @* todo: common, add to display code *@
                            @(location.LocationTypeCategory == LocationTypeCategory.FamilyHub ? "Yes" : "No")
                        </summary-row>
                        <summary-row key="Location details" class="fh-pre-wrap">@location.Description</summary-row>
                        <summary-row key="Days service is available" show-empty
                                     action1="Change" action1-href="#">Todo: add when available</summary-row>
                        <summary-row key="Service availability details" show-empty class="fh-pre-wrap"
                                     action1="Change" action1-href="#">Todo: add when available</summary-row>
                    </summary-card>
                }
            }
            <div class="govuk-button-group">
                <button type="submit" class="govuk-button" data-module="govuk-button">
                    Continue
                </button>
                @* todo: journey won't be enough to know where to send the user back to, now that there are 2 pages in the journey that can send them off *@
                @* todo: back button at start of add location journey doesn't come back to this page *@
                <a class="govuk-button govuk-button--secondary" href="/manage-locations/start-add-location?journey=@Journey.Service">Add another location</a>
            </div>
        </form>

    </div>
</div>